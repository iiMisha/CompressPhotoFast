# Правила разработки CompressPhotoFast

## Настройки
- **Язык общения**: Русский
- **ОС**: Linux Mint

## Memory Bank (ОБЯЗАТЕЛЬНО)

**В начале КАЖДОЙ задачи ОБЯЗАТЕЛЬНО прочитайте ВСЕ файлы из папки `.claude/memory-bank/`:**

- `brief.md` - краткое описание проекта
- `context.md` - текущий контекст и последние изменения
- `architecture.md` - архитектура приложения
- `tech.md` - технологический стек
- `tasks.md` - актуальные задачи (если есть)

После чтения укажите статус в начале ответа:
- `[Memory Bank: Active]` - файлы прочитаны
- `[Memory Bank: Missing]` - папка не существует

**См. подробнее:** `workflow-memory-bank.md`

## Сборка
ОБЯЗАТЕЛЬНО: После КАЖДОГО изменения кода выполняйте сборку измененного модуля (или полного проекта при изменениях в нескольких) для проверки. При составлении планов разработки также НЕОБХОДИМО указывать о необходимости производить сборку и исправлять ошибки после каждого шага.

## Тестирование
ОБЯЗАТЕЛЬНО: При изменении кода необходимо создавать необходимые unit и инструментальные тесты и проводить тестирование.

### Запуск тестов

**Только unit тесты:**
```bash
./gradlew testDebugUnitTest
```

**Все тесты (unit + instrumentation):**
```bash
./scripts/run_all_tests.sh
```

**Для запуска instrumentation тестов нужен эмулятор Small_Phone:**
- Откройте Android Studio → Device Manager
- Запустите AVD "Small_Phone"
- Или через командную строку (требует настроенный ANDROID_HOME):
```bash
export ANDROID_HOME=~/Android/Sdk
$ANDROID_HOME/emulator/emulator -avd Small_Phone
```

**Проверка покрытия кода:**
```bash
./gradlew jacocoTestReport
```
HTML отчет покрытия: `app/build/reports/jacoco/jacocoTestReport/html/index.html`

### Полная сборка
```bash
./gradlew assembleDebug
```

## Специализированные субагенты (ОБЯЗАТЕЛЬНО)

ОБЯЗАТЕЛЬНО используйте специализированные субагенты для выполнения задач:

### 1. Kotlin/Android разработка
- **`voltagent-lang:kotlin-specialist`** - для основной работы над проектом:
  - Написание и рефакторинг Kotlin кода
  - Работа с корутинами, Jetpack Compose, Android SDK
  - Написание unit и instrumentation тестов

### 2. Исследование кодовой базы
- **`Explore`** - ПЕРВЫМ для исследования:
  - Поиск файлов по паттернам
  - Поиск кода по ключевым словам
  - Ответы на вопросы о структуре кодовой базы

### 3. Тестирование
- **`voltagent-lang:kotlin-specialist`** - для написания тестов
- **`android-test-suite`** - для комплексного тестирования (skill)

### 4. Планирование
- **`Plan`** - для планирования разработки:
  - Анализ требований
  - Разработка плана реализации

### Когда НЕ использовать субагентов
❌ Для чтения конкретного файла → используйте **Read**
❌ Для поиска файла по имени → используйте **Glob**
❌ Для поиска в 2-3 файлах → используйте **Read**
❌ Для простых операций → выполняйте самостоятельно

### Принципы использования
✅ Запускайте агентов параллельно (одно сообщение с несколькими Task вызовами)
✅ Выбирайте специализированного агента под технологию
✅ Сначала Explore для исследования, затем специализированный агент
