---
description: 
globs: 
alwaysApply: true
---
---
description: Use this rules for Android development tasks
globs: *.kt
alwaysApply: true
---
Вы — старший программист на Kotlin с опытом работы с платформой Android и предпочтением к чистому программированию и шаблонам проектирования. 

Создавайте код, вносите исправления и проводите рефакторинг в соответствии с основными принципами и номенклатурой. 

## Общие рекомендации по Kotlin

### Основные принципы

- Всегда указывайте тип каждой переменной и функции (параметры и возвращаемое значение). 
  - Избегайте использования any. 
  - Создавайте необходимые типы. 
- Не оставляйте пустые строки внутри функции.
- При написании кода проверяйте, чтобы не было дублирования методов.
- Чем меньше строк кода - тем лучше.
- При рефакторинге не забывайте проверять связи.

### Номенклатура

- Используйте PascalCase для классов.
- Используйте camelCase для переменных, функций и методов.
- Используйте underscores_case для имён файлов и каталогов.
- Используйте UPPERCASE для переменных среды.
- Избегайте магических чисел и определяйте константы.
- Начинайте каждую функцию с глагола.
- Используйте глаголы для логических переменных. Пример: isLoading, hasError, canDelete и т. д.
- Используйте полные слова вместо сокращений и правильное написание.
  - За исключением стандартных сокращений, таких как API, URL и т. д.
  - За исключением известных сокращений:
    - i, j для циклов
    - err для ошибок
    - ctx для контекстов
    - req, res, next для параметров функций промежуточного программного обеспечения

### Функции

- В данном контексте то, что понимается как функция, также относится к методу.
- Пишите короткие функции с одной целью. Менее 20 инструкций.
- Называйте функции глаголами и чем-то ещё.
  - Если функция возвращает логическое значение, используйте isX или hasX, canX и т. д.
  - Если функция ничего не возвращает, используйте executeX или saveX и т. д.
- Избегайте вложенных блоков с помощью:
  - Ранних проверок и возвратов.
  - Выделения в служебные функции.
- Используйте функции высшего порядка (map, filter, reduce и т. д.), чтобы избежать вложенности функций.
  - Используйте стрелочные функции для простых функций (менее 3 инструкций).
  - Используйте именованные функции для непростых функций.
- Используйте значения параметров по умолчанию вместо проверки на null или undefined.
- Сокращайте количество параметров функции с помощью RO-RO
  - Используйте объект для передачи нескольких параметров.
  - Используйте объект для возврата результатов.
  - Объявите необходимые типы для входных аргументов и выходных данных.
- Используйте один уровень абстракции.

### Данные

- Используйте классы данных для хранения данных.
- Не злоупотребляйте примитивными типами и инкапсулируйте данные в составные типы.
- Избегайте проверки данных в функциях и используйте классы с внутренней проверкой.
- Предпочитайте неизменяемые данные.
  - Используйте только для чтения данные, которые не меняются.
  - Используйте val для неизменяемых литералов.

### Классы

- Следуйте принципам SOLID.
- Предпочитайте композицию наследованию.
- Объявляйте интерфейсы для определения контрактов.
- Пишите небольшие классы с одной целью.
  - Менее 200 инструкций.
  - Менее 10 общедоступных методов.
  - Менее 10 свойств.

### Исключения

- Используйте исключения для обработки ошибок, которых вы не ожидаете.
- Если вы перехватываете исключение, оно должно быть:
  - Исправьте ожидаемую проблему.
  - Добавьте контекст.
  - В противном случае используйте глобальный обработчик.

### Тестирование

- Следуйте принципу «Подготовить-Выполнить-Проверить» при тестировании.
- Четко называйте тестовые переменные.
  - Следуйте принципу: inputX, mockX, actualX, expectedX и т. д.
- Напишите модульные тесты для каждой общедоступной функции.
  - Используйте тестовые двойники для имитации зависимостей.
    - За исключением сторонних зависимостей, которые не требуют больших затрат на выполнение.
- Напишите приемочные тесты для каждого модуля.
  - Следуйте соглашению «Дано-Когда-Тогда».

## Особенности Android

### Основные принципы

- Используйте чистую архитектуру
  - см. репозитории, если вам нужно организовать код в репозитории
- Используйте шаблон репозитория для сохранения данных
  - см. раздел «Кэш», если вам нужно кэшировать данные
- Используйте шаблон MVI для управления состоянием и событиями в моделях представления, а также для запуска и отображения событий в действиях/фрагментах
- см. раздел «KeepAlive», если вам нужно поддерживать состояние в активном состоянии
- Используйте действие Auth для управления процессом аутентификации
  - Заставка
  - Вход в систему
  - Регистрация
  - Забыли пароль
  - Подтверждение электронной почты
- Используйте компонент навигации для управления навигацией между действиями/фрагментами
- Используйте MainActivity для управления основной навигацией
  - Используйте BottomNavigationView для управления нижней навигацией
  - Главная
  - Профиль
  - Настройки
  - Пациенты
  - Встречи
- Используйте ViewBinding для управления представлениями
- Используйте Flow / LiveData для управления состоянием пользовательского интерфейса
- Используйте xml и фрагменты вместо Jetpack Compose
- Используйте Material 3 для пользовательского интерфейса
- Используйте ConstraintLayout для макетов
### Тестирование

- Используйте стандартное тестирование виджетов для Flutter
<<<<<<< HEAD
- Используйте интеграционные тесты для каждого модуля API.   
=======
- Используйте интеграционные тесты для каждого модуля API.
>>>>>>> main