# –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è CompressPhotoFast

## –û–±–∑–æ—Ä

–°–æ–∑–¥–∞–Ω–∞ –ª–æ–∫–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è Android-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è CompressPhotoFast. –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —ç–º—É–ª—è—Ç–æ—Ä–µ –∏–ª–∏ —Ä–µ–∞–ª—å–Ω–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ —á–µ—Ä–µ–∑ ADB –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö.

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
./scripts/check_device.sh

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
./scripts/generate_test_images.sh

# –ó–∞–ø—É—Å–∫ unit —Ç–µ—Å—Ç–æ–≤
./scripts/run_unit_tests.sh

# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
./scripts/run_all_tests.sh
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

### Unit —Ç–µ—Å—Ç—ã

**–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è**: `app/src/test/java/com/compressphotofast/`

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫:
- `util/` - —Ç–µ—Å—Ç—ã —É—Ç–∏–ª–∏—Ç (MediaStoreUtil, ImageCompressionUtil, ExifUtil –∏ –¥—Ä.)
- `ui/` - —Ç–µ—Å—Ç—ã UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (ViewModel, LiveData)
- `worker/` - —Ç–µ—Å—Ç—ã Worker'–æ–≤ (ImageCompressionWorker)
- `service/` - —Ç–µ—Å—Ç—ã —Å–µ—Ä–≤–∏—Å–æ–≤ (BackgroundMonitoringService, ImageDetectionJobService)
- `di/` - —Ç–µ—Å—Ç—ã –º–æ–¥—É–ª–µ–π –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

**–†–µ—Å—É—Ä—Å—ã**: `app/src/test/resources/`
- `test_images/` - —Ç–µ—Å—Ç–æ–≤—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è —Ç–µ—Å—Ç–æ–≤

### Instrumentation —Ç–µ—Å—Ç—ã

**–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è**: `app/src/androidTest/java/com/compressphotofast/`

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫:
- `util/` - —Ç–µ—Å—Ç—ã —É—Ç–∏–ª–∏—Ç —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ Android API
- `ui/` - —Ç–µ—Å—Ç—ã UI —Å Espresso
- `worker/` - —Ç–µ—Å—Ç—ã Worker'–æ–≤ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
- `service/` - —Ç–µ—Å—Ç—ã —Å–µ—Ä–≤–∏—Å–æ–≤ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ

## –ë–∞–∑–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã –¥–ª—è —Ç–µ—Å—Ç–æ–≤

### BaseUnitTest

–ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è –≤—Å–µ—Ö unit —Ç–µ—Å—Ç–æ–≤. –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é MockK –¥–ª—è –º–æ–∫–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –ù–∞—Å—Ç—Ä–æ–π–∫—É TestDispatcher –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ—Ä—É—Ç–∏–Ω
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –æ—á–∏—Å—Ç–∫—É –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–æ–≤
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é Timber –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
```kotlin
class MyTest : BaseUnitTest() {
    private lateinit var myClass: MyClass

    @Before
    override fun setUp() {
        super.setUp()
        myClass = MyClass()
    }

    @Test
    fun testSomething() = runTest {
        // –¢–µ—Å—Ç–æ–≤—ã–π –∫–æ–¥
    }
}
```

### BaseInstrumentedTest

–ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –¥–ª—è –≤—Å–µ—Ö instrumentation —Ç–µ—Å—Ç–æ–≤. –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:
- –ù–∞—Å—Ç—Ä–æ–π–∫—É Hilt –¥–ª—è —Ç–µ—Å—Ç–æ–≤
- ActivityScenarioRule –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è Activity
- –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Espresso

–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
```kotlin
@HiltAndroidTest
class MainActivityTest : BaseInstrumentedTest() {
    
    @get:Rule
    override val hiltRule = HiltAndroidRule(this)
    
    @get:Rule
    override val activityRule = ActivityScenarioRule(MainActivity::class.java)
    
    @Inject
    lateinit var viewModelFactory: ViewModelProvider.Factory
    
    @Before
    fun setup() {
        hiltRule.inject()
    }
    
    @Test
    fun testMainActivity() {
        // Espresso —Ç–µ—Å—Ç—ã
    }
}
```

### CoroutinesTestRule

–ü—Ä–∞–≤–∏–ª–æ JUnit –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ—Ä—É—Ç–∏–Ω. –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:
- TestDispatcher –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ—Ä—É—Ç–∏–Ω
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –Ω–∞—Å—Ç—Ä–æ–π–∫—É MainDispatcher
- –ú–µ—Ç–æ–¥ `runTest` –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –±–ª–æ–∫–æ–≤

## –°–∫—Ä–∏–ø—Ç—ã

1. **check_device.sh** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
2. **run_unit_tests.sh** - –∑–∞–ø—É—Å–∫ —Ç–æ–ª—å–∫–æ unit —Ç–µ—Å—Ç–æ–≤
3. **run_all_tests.sh** - –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
4. **generate_test_images.sh** - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

### generate_test_images.sh

–°–∫—Ä–∏–ø—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º ImageMagick.

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è**:
- ImageMagick (—É—Å—Ç–∞–Ω–æ–≤–∫–∞: `sudo apt-get install imagemagick`)
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: exiftool –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è EXIF-–¥–∞–Ω–Ω—ã—Ö

**–ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è**:
- `test_image_small.jpg` - 100x100 –ø–∏–∫—Å–µ–ª–µ–π, ~50 –ö–ë
- `test_image_medium.jpg` - 800x600 –ø–∏–∫—Å–µ–ª–µ–π, ~200 –ö–ë
- `test_image_large.jpg` - 1920x1080 –ø–∏–∫—Å–µ–ª–µ–π, ~500 –ö–ë
- `test_image_huge.jpg` - 4000x3000 –ø–∏–∫—Å–µ–ª–µ–π, ~2 –ú–ë
- `test_image_with_exif.jpg` - 800x600 —Å EXIF-–¥–∞–Ω–Ω—ã–º–∏
- `test_image_screenshot.png` - —Å–∫—Ä–∏–Ω—à–æ—Ç (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏)
- `test_image_heic.heic` - HEIC —Ñ–æ—Ä–º–∞—Ç (–µ—Å–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è)
- `test_image_too_small.jpg` - –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–µ–Ω—å—à–µ 100 –ö–ë
- `test_image_low_quality.jpg` - –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å –Ω–∏–∑–∫–∏–º –∫–∞—á–µ—Å—Ç–≤–æ–º
- `test_image_high_quality.jpg` - –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å –≤—ã—Å–æ–∫–∏–º –∫–∞—á–µ—Å—Ç–≤–æ–º
- `test_image.png` - PNG –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ

## Gradle –∫–æ–º–∞–Ω–¥—ã

```bash
# Unit —Ç–µ—Å—Ç—ã
./gradlew testDebugUnitTest

# Instrumentation —Ç–µ—Å—Ç—ã
./gradlew connectedDebugAndroidTest

# Coverage –æ—Ç—á–µ—Ç
./gradlew jacocoTestReport

# –í—Å–µ —Ç–µ—Å—Ç—ã + coverage
./gradlew checkAllTests

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ coverage (30%)
./gradlew jacocoTestCoverageVerification
```

## Coverage

- HTML –æ—Ç—á–µ—Ç: `app/build/reports/jacoco/jacocoTestReport/html/index.html`
- –¶–µ–ª–µ–≤–æ–π coverage: 50-70%
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π coverage: 30%
- –¢–µ–∫—É—â–∏–π: ~8% (—è–Ω–≤–∞—Ä—å 2026)

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–∫—Ä—ã—Ç–∏—è (—è–Ω–≤–∞—Ä—å 2026)

- **–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏**: 8% (2,746 –∏–∑ 30,282)
- **–í–µ—Ç–∫–∏**: 0% (30 –∏–∑ 30)
- **–ö–ª–∞—Å—Å—ã**: 0% (3,008 –∏–∑ 3,008)
- **–ú–µ—Ç–æ–¥—ã**: 0% (3,443 –∏–∑ 3,468)

### –ü–æ–∫—Ä—ã—Ç—ã–µ –º–æ–¥—É–ª–∏

–ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã:
- ‚úÖ `PerformanceMonitor` - –º–æ–Ω–∏—Ç–æ—Ä –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–ø–æ–ª–Ω–æ—Å—Ç—å—é)
- ‚úÖ `CompressionBatchTracker` - —Ç—Ä–µ–∫–µ—Ä –±–∞—Ç—á–µ–π —Å–∂–∞—Ç–∏—è (–ø–æ–ª–Ω–æ—Å—Ç—å—é)
- ‚úÖ `StatsTracker` - —Å–±–æ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (–ø–æ–ª–Ω–æ—Å—Ç—å—é)
- ‚úÖ `SettingsManager` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ (–ø–æ–ª–Ω–æ—Å—Ç—å—é)
- ‚úÖ `Constants` - –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–ø–æ–ª–Ω–æ—Å—Ç—å—é)
- ‚úÖ `Event` –∏ `EventObserver` - —Å–æ–±—ã—Ç–∏–π–Ω–∞—è –º–æ–¥–µ–ª—å (–ø–æ–ª–Ω–æ—Å—Ç—å—é)
- ‚úÖ `LogUtil` - —É—Ç–∏–ª–∏—Ç–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (–ø–æ–ª–Ω–æ—Å—Ç—å—é)
- ‚úÖ `FileOperationsUtil` - –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å —Ñ–∞–π–ª–∞–º–∏ (—á–∞—Å—Ç–∏—á–Ω–æ)

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Gradle

### testOptions

–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è unit —Ç–µ—Å—Ç–æ–≤:
```kotlin
testOptions {
    unitTests {
        isIncludeAndroidResources = true
        isReturnDefaultValues = true
        all {
            maxParallelForks = 4
        }
    }
}
```

### JaCoCo –∏—Å–∫–ª—é—á–µ–Ω–∏—è

–ò—Å–∫–ª—é—á–µ–Ω–Ω—ã–µ –∫–ª–∞—Å—Å—ã –∏–∑ coverage:
- `**/databinding/**` - —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–ª–∞—Å—Å—ã ViewBinding
- `**/di/Hilt_*` - —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–ª–∞—Å—Å—ã Hilt
- `**/BR.class` - —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª–∞—Å—Å ViewBinding
- `**/BuildConfig.*` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–±–æ—Ä–∫–∏
- `**/R.class` –∏ `**/R$*.class` - —Ä–µ—Å—É—Ä—Å—ã Android
- `**/*_HiltModules*` - –º–æ–¥—É–ª–∏ Hilt
- `**/*_MembersInjector*` - –∏–Ω–∂–µ–∫—Ç–æ—Ä—ã Hilt
- `**/*_Factory*` - —Ñ–∞–±—Ä–∏–∫–∏ Hilt
- `**/*_Provide*Factory*` - –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã Hilt

## –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

### ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (–≠—Ç–∞–ø 1 - –∑–∞–≤–µ—Ä—à—ë–Ω)
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫ –¥–ª—è —Ç–µ—Å—Ç–æ–≤ (unit –∏ instrumentation)
- –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å `BaseUnitTest` –¥–ª—è –≤—Å–µ—Ö unit —Ç–µ—Å—Ç–æ–≤
- CoroutinesTestRule –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ—Ä—É—Ç–∏–Ω (–∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ BaseUnitTest)
- –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Gradle (testOptions, JaCoCo)
- –°–∫—Ä–∏–ø—Ç-–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Ç–µ—Å—Ç–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –ó–∞–¥–∞—á–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ coverage (30%)
- **217 —Ç–µ—Å—Ç–æ–≤**, –≤—Å–µ –ø—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ

### ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (–≠—Ç–∞–ø 2 - –∑–∞–≤–µ—Ä—à—ë–Ω)
- Unit —Ç–µ—Å—Ç—ã –¥–ª—è —É—Ç–∏–ª–∏—Ç –ø–∞–∫–µ—Ç–∞ `util`:
  - `PerformanceMonitorTest` - 30 —Ç–µ—Å—Ç–æ–≤
  - `CompressionBatchTrackerTest` - 15 —Ç–µ—Å—Ç–æ–≤
  - `StatsTrackerTest` - 20 —Ç–µ—Å—Ç–æ–≤
  - `SettingsManagerTest` - 25 —Ç–µ—Å—Ç–æ–≤
  - `ConstantsTest` - 10 —Ç–µ—Å—Ç–æ–≤
  - `EventTest` –∏ `EventObserverTest` - 15 —Ç–µ—Å—Ç–æ–≤
  - `LogUtilTest` - 12 —Ç–µ—Å—Ç–æ–≤
  - `FileOperationsUtilTest` - 18 —Ç–µ—Å—Ç–æ–≤
- **–¢–µ—Å—Ç–æ–≤—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π** (`TestImageGenerator`)
- **Mock-–∫–æ–Ω—Ç–µ–∫—Å—Ç** –¥–ª—è —Ç–µ—Å—Ç–æ–≤
- **TestUtilities** - –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ç–µ—Å—Ç–æ–≤
- **WorkManagerTestModule** - –º–æ–¥—É–ª—å –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è WorkManager
- **robolectric.properties** - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Robolectric

### ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (–≠—Ç–∞–ø 3 - –∑–∞–≤–µ—Ä—à–µ–Ω –∏ –ø—Ä–µ–¥–µ–ª—å–Ω–æ —Ä–∞—Å—à–∏—Ä–µ–Ω)
- **Instrumentation UI —Ç–µ—Å—Ç—ã –¥–ª—è MainActivity:**
  - `MainActivityTest` - 40 UI —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—Å–µ—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø—É—Å–∫–∞ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è UI
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–µ–π
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ —Å–∂–∞—Ç–∏—è
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞ —Ñ–æ—Ç–æ
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ª–æ–∂–Ω—ã—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∏–¥–∏–º–æ—Å—Ç–∏ –∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤ –∏ –æ–ø–∏—Å–∞–Ω–∏–π
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è UI –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥—Ä–∞–Ω–∏—á–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ UI –ø—Ä–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏—è—Ö
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ initialState –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- **Instrumentation —Ç–µ—Å—Ç—ã –¥–ª—è BroadcastReceiver:**
  - `BootCompletedReceiverTest` - 6 —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è Receiver
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ BOOT_COMPLETED –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–Ω–æ–º –∞–≤—Ç–æ—Å–∂–∞—Ç–∏–∏
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ BOOT_COMPLETED –ø—Ä–∏ –≤—ã–∫–ª—é—á–µ–Ω–Ω–æ–º –∞–≤—Ç–æ—Å–∂–∞—Ç–∏–∏
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ null –∏–Ω—Ç–µ–Ω—Ç–∞
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ —á—Ç–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–µ–∫:**
  - `SettingsIntegrationTest` - 10 —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã —Å SharedPreferences
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ —á—Ç–µ–Ω–∏—è –≤—Å–µ—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∞—Å—Å–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç:**
  - `ConstantsIntegrationTest` - 10 —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–Ω–∞—á–µ–Ω–∏–π –≤—Å–µ—Ö –≤–∞–∂–Ω—ã—Ö –∫–æ–Ω—Å—Ç–∞–Ω—Ç
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ Actions –∏ Extras –¥–ª—è Intent
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Ä–æ–≤–Ω–µ–π –∫–∞—á–µ—Å—Ç–≤–∞ —Å–∂–∞—Ç–∏—è
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è URI:**
  - `UriIntegrationTest` - 10 —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã —Å URI
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ URI
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ö–µ–º—ã, –ø—É—Ç–∏ –∏ authority
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è URI
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è Event:**
  - `EventIntegrationTest` - 10 —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–±—ã—Ç–∏–π–Ω–æ–π –º–æ–¥–µ–ª–∏
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ Event –∏ EventObserver
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ getContentIfNotHandled –∏ peekContent
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –∏ Unit —Ç–µ—Å—Ç—ã –¥–ª—è HEIC —Ñ–æ—Ä–º–∞—Ç–∞:**
  - `HeicFormatTest` - 10 instrumentation —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ HEIC
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ MIME —Ç–∏–ø–∞ –¥–ª—è HEIC
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ HEIC –≤ ImageProcessingChecker
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è HEIC —Ñ–∞–π–ª–æ–≤
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è URI –¥–ª—è HEIC —Ñ–∞–π–ª–æ–≤
  - `HeicProcessingTest` - 10 unit —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ HEIC
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è HEIC MIME —Ç–∏–ø–∞
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–æ–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–≥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ HEIF —Ñ–æ—Ä–º–∞—Ç–∞
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è HEIC —Ñ–∞–π–ª–æ–≤
- **–°–∫—Ä–∏–ø—Ç –¥–ª—è instrumentation —Ç–µ—Å—Ç–æ–≤:** `run_instrumentation_tests.sh`

### ‚è≥ –í –ø–ª–∞–Ω–∞—Ö (–≠—Ç–∞–ø 4)
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ instrumentation —Ç–µ—Å—Ç—ã –¥–ª—è PermissionsManager
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ instrumentation —Ç–µ—Å—Ç—ã –¥–ª—è BackgroundMonitoringService
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ instrumentation —Ç–µ—Å—Ç—ã –¥–ª—è ImageDetectionJobService
- Unit —Ç–µ—Å—Ç—ã –¥–ª—è MainViewModel (—Ç—Ä–µ–±—É–µ—Ç —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Å–∏–Ω–≥–ª—Ç–æ–Ω–æ–≤)
- Unit —Ç–µ—Å—Ç—ã –¥–ª—è ImageCompressionWorker
- –£–≤–µ–ª–∏—á–µ–Ω–∏–µ coverage –¥–æ 50-70%
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### Unit —Ç–µ—Å—Ç—ã
- JUnit 4.13.2
- Robolectric 4.11
- MockK 1.13.10
- kotlinx-coroutines-test 1.10.2
- androidx.arch.core:core-testing 2.2.0
- Hilt Testing 2.57.1
- **androidx.work:work-testing:2.10.3** (–¥–æ–±–∞–≤–ª–µ–Ω–æ –¥–ª—è unit —Ç–µ—Å—Ç–æ–≤)

### Instrumentation —Ç–µ—Å—Ç—ã
- JUnit (androidx.test.ext:junit)
- Espresso 3.6.1
- UIAutomator 2.3.0
- MockK-Android 1.13.10
- WorkManager Testing 2.10.3
- Hilt Testing 2.57.1

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–Ø–Ω–≤–∞—Ä—å 2026)

- **–í—Å–µ–≥–æ unit —Ç–µ—Å—Ç–æ–≤:** 251
- **–ü—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ:** 238 (94.8%)
- **Instrumentation —Ç–µ—Å—Ç—ã:** 96 (MainActivityTest + BootCompletedReceiverTest + 6 –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ + HEIC + –ò–º–µ–Ω–∞/MIME)
  - MainActivityTest: 40 —Ç–µ—Å—Ç–æ–≤
  - BootCompletedReceiverTest: 6 —Ç–µ—Å—Ç–æ–≤
  - SettingsIntegrationTest: 10 —Ç–µ—Å—Ç–æ–≤
  - ConstantsIntegrationTest: 10 —Ç–µ—Å—Ç–æ–≤
  - UriIntegrationTest: 10 —Ç–µ—Å—Ç–æ–≤
  - EventIntegrationTest: 10 —Ç–µ—Å—Ç–æ–≤
  - HeicFormatTest: 10 —Ç–µ—Å—Ç–æ–≤
  - FileNameAndMimeTypeTest: 10 —Ç–µ—Å—Ç–æ–≤ (–Ω–æ–≤—ã–µ)
- **–í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤:** 347 (251 unit + 96 instrumentation)
- **–û–±—â–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ:** ~8-10%
- **–¶–µ–ª–µ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ:** 60-70%
- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ HEIC:** ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞ (20 —Ç–µ—Å—Ç–æ–≤)
- **–î–≤–æ–π–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è:** ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –∏ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ (20 —Ç–µ—Å—Ç–æ–≤)

## –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã (–Ø–Ω–≤–∞—Ä—å 2026)

### üî¥ –î–≤–æ–π–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:** –°–æ–∑–¥–∞—é—Ç—Å—è —Ñ–∞–π–ª—ã —Å –¥–≤–æ–π–Ω—ã–º–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `image.HEIC.jpg`)

**–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏:** –°–º. [DOUBLE_EXTENSION_PROBLEM.md](../DOUBLE_EXTENSION_PROBLEM.md)

**–°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã:**
- `FileNameAndMimeTypeTest` - 10 instrumentation —Ç–µ—Å—Ç–æ–≤
- `FileNameProcessingTest` - 10 unit —Ç–µ—Å—Ç–æ–≤

**–ü–ª–∞–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
1. –û—á–∏—Å—Ç–∫–∞ –¥–≤–æ–π–Ω—ã—Ö —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π –≤ `FileOperationsUtil.createCompressedFileName()`
2. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ MIME —Ç–∏–ø–∞
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ MIME —Ç–∏–ø–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏

**–¢–µ–∫—É—â–µ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:**
- MIME —Ç–∏–ø –≤—Å–µ–≥–¥–∞ hardcoded –∫–∞–∫ `"image/jpeg"`
- –î–≤–æ–π–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –Ω–µ –æ—á–∏—â–∞—é—Ç—Å—è
- –ò—Å—Ö–æ–¥–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç (HEIC/HEIF) –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è

**–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:**
- –ß–∏—Å—Ç—ã–µ –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ (–æ–¥–Ω–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ)
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π MIME —Ç–∏–ø –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞

